{"version":3,"file":"dialog.js","mappings":"CAAA,WACI,aAQAA,OAAOC,WAAa,SAASC,GACzBC,EAAEC,UAAUC,OAAM,WAYtB,IACQC,EACAC,EACAC,EAFAF,EAASG,KAAKC,MAAMC,aAAaC,QAAQ,WACzCL,EAAUI,aAAaC,QAAQ,WAC/BJ,EAAcC,KAAKC,MAAMC,aAAaC,QAAQ,gBAqCtD,SAAsBC,EAAoBN,GAA0B,IAAjBC,EAAiB,uDAAH,GAC7D,GAAyB,MAAtBK,GAAyC,MAAXN,GAAkC,MAAfC,IAIpDL,EAAE,cAAcW,KAAKD,GACrBV,EAAE,eAAeW,KAAKP,GACnBC,EAAYO,OAAS,GAAE,CACtBC,QAAQC,IAAI,8BACZd,EAAE,0BAA0Be,IAAI,UAAW,UAC3C,IAAI,IAAIC,EAAI,EAAGA,EAAIX,EAAYO,OAAQI,IAAI,CACvC,IAAIC,EAAaZ,EAAYW,GAC7BhB,EAAE,mBAAmBkB,OAAO,OAAQD,EAAWE,KAAO,KAAMF,EAAWG,KAAKC,cAAe,WA/CnGC,CAAanB,EAAOoB,aAAcnB,EAASC,GAM3CL,EAAEwB,KAAK,CACHC,IAFuB,6HAGvBC,KAAM,MACNC,MAAO,SAASC,EAAIC,EAAOF,GAEvB3B,EAAE,eAAeW,KAAK,eAAiBiB,EAAM,aAAeC,EAAS,YAAcF,MAExFG,MAAK,SAASC,GAuCrB,IAAyBC,EAAUC,EAASC,EAAnBF,EAtCDD,EAAKZ,KAsCMc,EAtCAF,EAAKE,QAAQ,GAAGE,YAsCPD,EAtCoBH,EAAKK,KAAKC,KAuCtErC,EAAE,gBAAgBW,KAAKqB,GACvBhC,EAAE,eAAeW,KAAKsB,GACtBjC,EAAE,mBAAmBW,KAAKuB,EA7ER,KAqCdrB,QAAQC,IAAI,yCAMhBd,EAAEwB,KAAK,CACHC,IA3CQ,qCA4CRC,KAAM,MACNC,MAAO,SAASI,GAEZlB,QAAQC,IAAI,iDACZd,EAAE,gBAAgBW,KAAK,kCAE5BmB,MAAK,SAASC,GA6BrB,IAAqBZ,EA5BbN,QAAQC,IAAI,+BA4BCK,EA3BDb,KAAKgC,UAAUP,GA4B/B/B,EAAE,gBAAgBW,KAAKQ,MAtEnBnB,EAAE,mBAAmBe,IAAI,UAAW,UAEpCP,aAAa+B,YAwErBC,OAAOC,UAAUpB,YAAc,WAC3B,IAEIL,EADA0B,EAAQC,KAGZ,IAAK3B,EAAI,EAAG0B,GAAS,MAAQ1B,EAAI,EAAGA,IAChC0B,GAAS,KAGb,OAAOA,EAAME,QAAQ,GART,CAAC,IAAK,KAAM,KAAM,KAAM,MAQJ5B,IAnGxC","sources":["webpack:///./src/settings/dialog.js?"],"sourcesContent":["(function(){\r\n    'use strict';\r\n\r\n    // Constant values\r\n    var openweathermapAPPID = \"207a941d81bb0d89109c0ce6af589bec\"; // The ID used to connect to the openweathermap API (free account, mime@dialgika.de)\r\n    var celciusUnicode =  \"\\u2103\"; // Unicode for â„ƒ\r\n    var enyconAPI = \"https://10.31.0.32:8000/id/ECN2007\";\r\n\r\n    // The Office initialize function must be run each time a new page is loaded.\r\n    Office.initialize = function(reason){\r\n        $(document).ready(function(){\r\n\r\n            retrieveMailData();\r\n            retrieveWeatherData(\"saarbruecken\", \"en\", \"metric\");\r\n            retrieveSAPUser();\r\n\r\n            $(\"#info-container\").css(\"display\", \"inline\");\r\n\r\n            localStorage.clear();\r\n        })\r\n    };\r\n\r\n    function retrieveMailData(){\r\n        var sender = JSON.parse(localStorage.getItem(\"sender\"));\r\n        var subject = localStorage.getItem(\"subject\");\r\n        var attachments = JSON.parse(localStorage.getItem(\"attachments\"));\r\n\r\n        loadMailData(sender.emailAddress, subject, attachments);\r\n    }\r\n\r\n    function retrieveWeatherData(location, language, unit){\r\n        // TODO: cache results of openweathermap to avoid reaching limit\r\n        var urlOpenweathermapAPI = \"https://api.openweathermap.org/data/2.5/weather?q=\"+ location + \"&appid=\" + openweathermapAPPID + \"&units=\" + unit + \"&lang=\" + language;\r\n        $.ajax({\r\n            url: urlOpenweathermapAPI,\r\n            type: 'GET',\r\n            error: function(xhr,status,error){\r\n                //TODO: Proper error handling\r\n                $(\"#weather-id\").text(\"ERROR: xhr: \" + xhr + \", status: \" + status + \", error: \" + error);\r\n            }\r\n        }).done(function(data){\r\n            loadWeatherData(data.name, data.weather[0].description, data.main.temp);\r\n            console.log(\"SOI-LOG: Current weather retrieved\");\r\n        })\r\n    }\r\n\r\n    function retrieveSAPUser(){\r\n        // TODO: Ajax call to SAP webservice        \r\n        $.ajax({\r\n            url: enyconAPI,\r\n            type: 'GET',\r\n            error: function(data){\r\n                //TODO: Proper error handling\r\n                console.log(\"SOI-Log: Could not retrieve data on SAP user,\");\r\n                $(\"#sap-user-id\").text(\"Unable to retrieve SAP user\");\r\n            }\r\n        }).done(function(data){\r\n            console.log(\"SOI-LOG: SAP-User retrieved\");\r\n            loadSAPUser(JSON.stringify(data));\r\n        })\r\n    }\r\n\r\n    function loadMailData(senderEmailAddress, subject, attachments = []){\r\n        if(senderEmailAddress == null || subject == null || attachments == null){\r\n            // TODO: Couldnt retrieve data, display error\r\n            return;\r\n        }\r\n        $(\"#sender-id\").text(senderEmailAddress);\r\n        $(\"#subject-id\").text(subject); \r\n        if(attachments.length > 0){\r\n            console.log(\"SOI-LOG: attachments found\");\r\n            $(\"#attachments-container\").css(\"display\", \"inline\");\r\n            for(let i = 0; i < attachments.length; i++){\r\n                var attachment = attachments[i];\r\n                $(\"#attachments-id\").append(\"<li>\" +attachment.name + \", \"+ attachment.size.formatBytes() +\"</li>\")\r\n            }\r\n        }\r\n    }\r\n\r\n    function loadWeatherData(location, weather, temperature){\r\n        $(\"#location-id\").text(location);\r\n        $(\"#weather-id\").text(weather);\r\n        $(\"#temperature-id\").text(temperature + celciusUnicode);\r\n    }\r\n\r\n    function loadSAPUser(name){\r\n        $(\"#sap-user-id\").text(name);\r\n    }\r\n\r\n    // formatBytes taken from: https://stackoverflow.com/questions/15900485/correct-way-to-convert-size-in-bytes-to-kb-mb-gb-in-javascript\r\n    Number.prototype.formatBytes = function() {\r\n        var units = ['B', 'KB', 'MB', 'GB', 'TB'],\r\n            bytes = this,\r\n            i;\r\n     \r\n        for (i = 0; bytes >= 1024 && i < 4; i++) {\r\n            bytes /= 1024;\r\n        }\r\n     \r\n        return bytes.toFixed(2) + units[i];\r\n    }\r\n  })();\r\n\r\n"],"names":["Office","initialize","reason","$","document","ready","sender","subject","attachments","JSON","parse","localStorage","getItem","senderEmailAddress","text","length","console","log","css","i","attachment","append","name","size","formatBytes","loadMailData","emailAddress","ajax","url","type","error","xhr","status","done","data","location","weather","temperature","description","main","temp","stringify","clear","Number","prototype","bytes","this","toFixed"],"sourceRoot":""}